[platformio]
default_envs = t-embed-cc1101

; ============================================================================
; Shared settings for all ESP32-S3 boards
; ============================================================================
[env_common_s3]
platform = https://github.com/pioarduino/platform-espressif32/releases/download/55.03.36/platform-espressif32.zip
framework = arduino
monitor_speed = 115200
upload_speed = 460800
board_build.arduino.memory_type = qio_opi

build_flags =
  -I include
  -DLV_CONF_INCLUDE_SIMPLE
  -DLV_CONF_PATH=\"${PROJECT_DIR}/include/lv_conf.h\"
  -finput-charset=UTF-8
  -fexec-charset=UTF-8
  -DCORE_DEBUG_LEVEL=1
  -DARDUINO_USB_MODE=1
  -DARDUINO_USB_CDC_ON_BOOT=1
  -DUSER_SETUP_LOADED
  -DUSE_FSPI_PORT
  -DSMOOTH_FONT=1

lib_deps =
  lvgl/lvgl @ 9.4.0
  bblanchon/ArduinoJson @ ^6.21.5
  links2004/WebSockets @ ^2.6.1
  sui77/rc-switch @ ^2.6.4
  bodmer/TFT_eSPI @ ^2.5.43
  mathertel/RotaryEncoder @ 1.5.3
  h2zero/NimBLE-Arduino @ ^2.3.7
  lewisxhe/XPowersLib @ ^0.3.3
  https://github.com/schreibfaul1/ESP32-audioI2S.git#3.4.0
  rweather/Crypto @ 0.4.0
  adafruit/Adafruit PN532 @ ^1.3.4
  miguelbalboa/MFRC522 @ ^1.4.12
  nrf24/RF24 @ ^1.4.11
  https://github.com/bmorcelli/SmartRC-CC1101-Driver-Lib/

; ============================================================================
; LilyGo T-Embed CC1101 (original target)
; ESP32-S3 | 16 MB Flash | 8 MB PSRAM | ST7789 170x320 | CC1101 built-in
; ============================================================================
[env:t-embed-cc1101]
extends = env_common_s3
board = lilygo-t-embed-cc1101
board_build.partitions = default_16MB.csv

build_flags =
  ${env_common_s3.build_flags}
  -DBOARD_T_EMBED_CC1101
  -DST7789_DRIVER=1
  -DTFT_INVERSION_ON
  -DTFT_WIDTH=170
  -DTFT_HEIGHT=320
  -DTFT_MISO=10
  -DTFT_MOSI=9
  -DTFT_SCLK=11
  -DTFT_CS=41
  -DTFT_DC=16
  -DTFT_RST=40
  -DSPI_FREQUENCY=40000000
  -DSPI_READ_FREQUENCY=20000000

; ============================================================================
; LilyGo T-Deck
; ESP32-S3 | 16 MB Flash | 8 MB PSRAM | ST7789 320x240 | Keyboard + Trackball
; ============================================================================
[env:t-deck]
extends = env_common_s3
board = lilygo-t-deck
board_build.partitions = default_16MB.csv

build_flags =
  ${env_common_s3.build_flags}
  -DBOARD_T_DECK
  -DST7789_DRIVER=1
  -DTFT_INVERSION_ON
  -DTFT_WIDTH=320
  -DTFT_HEIGHT=240
  -DTFT_MISO=38
  -DTFT_MOSI=41
  -DTFT_SCLK=40
  -DTFT_CS=12
  -DTFT_DC=11
  -DTFT_RST=-1
  -DSPI_FREQUENCY=40000000
  -DSPI_READ_FREQUENCY=20000000

; ============================================================================
; M5Stack Cardputer
; ESP32-S3 | 8 MB Flash | No PSRAM | ST7789 240x135 | Built-in Keyboard
; ============================================================================
[env:cardputer]
extends = env_common_s3
board = m5stack-stamps3
board_build.partitions = default_8MB.csv

build_flags =
  ${env_common_s3.build_flags}
  -DBOARD_CARDPUTER
  -DST7789_DRIVER=1
  -DTFT_INVERSION_ON
  -DTFT_WIDTH=240
  -DTFT_HEIGHT=135
  -DTFT_MISO=-1
  -DTFT_MOSI=35
  -DTFT_SCLK=36
  -DTFT_CS=37
  -DTFT_DC=34
  -DTFT_RST=33
  -DSPI_FREQUENCY=40000000
  -DSPI_READ_FREQUENCY=20000000

; ============================================================================
; CYD (Cheap Yellow Display) ESP32-2432S028R
; ESP32 (classic) | 4 MB Flash | No PSRAM | ILI9341 320x240 | Touchscreen
; ============================================================================
[env:cyd-2432s028]
platform = https://github.com/pioarduino/platform-espressif32/releases/download/55.03.36/platform-espressif32.zip
framework = arduino
board = esp32dev
monitor_speed = 115200
upload_speed = 460800

build_flags =
  -I include
  -DLV_CONF_INCLUDE_SIMPLE
  -DLV_CONF_PATH=\"${PROJECT_DIR}/include/lv_conf.h\"
  -finput-charset=UTF-8
  -fexec-charset=UTF-8
  -DCORE_DEBUG_LEVEL=1
  -DUSER_SETUP_LOADED
  -DSMOOTH_FONT=1
  -DBOARD_CYD_2432S028
  -DILI9341_DRIVER=1
  -DTFT_WIDTH=320
  -DTFT_HEIGHT=240
  -DTFT_MISO=12
  -DTFT_MOSI=13
  -DTFT_SCLK=14
  -DTFT_CS=15
  -DTFT_DC=2
  -DTFT_RST=-1
  -DSPI_FREQUENCY=40000000
  -DSPI_READ_FREQUENCY=20000000

lib_deps =
  lvgl/lvgl @ 9.4.0
  bblanchon/ArduinoJson @ ^6.21.5
  links2004/WebSockets @ ^2.6.1
  sui77/rc-switch @ ^2.6.4
  bodmer/TFT_eSPI @ ^2.5.43
  mathertel/RotaryEncoder @ 1.5.3
  h2zero/NimBLE-Arduino @ ^2.3.7
  rweather/Crypto @ 0.4.0
  https://github.com/bmorcelli/SmartRC-CC1101-Driver-Lib/

; ============================================================================
; ESP32-S3 Generic DevKit (headless / serial-only)
; No display, no built-in peripherals. CC1101 via external SPI wiring.
; ============================================================================
[env:esp32s3-generic]
extends = env_common_s3
board = esp32-s3-devkitc-1
board_build.partitions = default_8MB.csv

build_flags =
  ${env_common_s3.build_flags}
  -DBOARD_ESP32_GENERIC
  -DST7789_DRIVER=1
  -DTFT_WIDTH=170
  -DTFT_HEIGHT=320
  -DTFT_MISO=-1
  -DTFT_MOSI=-1
  -DTFT_SCLK=-1
  -DTFT_CS=-1
  -DTFT_DC=-1
  -DTFT_RST=-1
  -DSPI_FREQUENCY=10000000
  -DSPI_READ_FREQUENCY=10000000
